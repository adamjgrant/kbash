// VARIABLES
// =========
function cursorSwitch(e){switch(e){case 0:$(span).html("&#9617;").removeClass("skinny");break;case 1:$(span).html("&#9608;").removeClass("skinny");break;case 2:$(span).html("&#8739;").addClass("skinny")}}function getCommandArray(e){return commandArray[e]}function getResponse(e){var t=e.split(" ");if(typeof kbash[t[0]]=="function"){var n=t.slice(1,t.length),r={rootCommand:t[0],args:[],flags:[],opts:[],props:{empty:!0}};for(var i=0;i<n.length;i++)n[i].substr(0,1)=="-"&&(n[i].substr(0,2)=="--"?r.opts.push(n[i].substring(2,n[i].length)):r.flags=r.flags.concat(n[i].substring(1,n[i].length).split("")),n.remove(i),i--);r.args=n;if(r.args.length>0||r.flags.length>0||r.opts.length>0)r.props.empty=!1;kbash[r.rootCommand](r.args,r.flags,r.opts,r.props)}else console.kbash("-kbash: "+e+": command not found.")}function setInput(){var e=getCommandArray(commandArray.length+commandSpot);$(input).val(e),setCursor(),$("body").focus(),$(input).putCursorAtEnd()}function setCommandArray(e){commandArray=commandArray.concat(e),console.kbash("> "+e),setRequest(e),$(input).val(""),setCursor(),localStorage.setItem("commandArray",JSON.stringify(commandArray))}function setCursor(e){e=e||cursorSpot,cursorSpot<0?$(fakeInput).html($(input).val().substr(0,$(input).val().length+cursorSpot)):$(fakeInput).html($(input).val())}function setRequest(e){getResponse(e)}var cursorSpot=0,commandArray=typeof localStorage["commandArray"]=="string"?JSON.parse(localStorage.commandArray):["help"],commandSpot=0,mouseIn=!1,kbash=new Object;Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,n)},function(e){jQuery.fn.putCursorAtEnd=function(){return this.each(function(){e(this).focus();if(this.setSelectionRange){var t=e(this).val().length*2;this.setSelectionRange(t,t)}else e(this).val(e(this).val());this.scrollTop=999999})}}(jQuery),Array.prototype.have=function(e){return this.indexOf(e)>-1?!0:!1},$("body").append('<footer class="debug"></footer>'),$("footer.debug").append("<input>").append('<nav class="console"></nav>').append('<nav class="input"></nav>'),$("nav.input").append('&gt;&nbsp;<span class="input"></span>').append('<span class="cursor"></span>').append('<span class="input-last"></span>'),$("span.cursor").append("&#9617;");var nav=$("footer.debug nav"),input=$("footer.debug input"),span=$("span.cursor"),mainConsole=$("nav.console"),fakeInput=$("span.input"),fakeInputLast=$("span.input-last");$(nav).click(function(){$(input).focus(),cursorSpot==0?cursorSwitch(1):cursorSwitch(2),$(mainConsole).fadeIn("fast")}),$(input).on("blur",function(){cursorSwitch(0),mouseIn||$(mainConsole).fadeOut("fast")}),$(mainConsole).hover(function(){mouseIn=!0},function(){mouseIn=!1}),$(input).keyup(function(e){e.keyCode!=37&&setCursor(0),e.keyCode==13&&(e.preventDefault(),$(input).val().length>0&&(setCommandArray($(input).val()),commandSpot=0,cursorSpot=0,$(fakeInputLast).html("")))}),$(input).keydown(function(e){e.keyCode==38&&(e.preventDefault(),commandSpot--,setInput()),e.keyCode==40&&(e.preventDefault(),commandSpot++,setInput()),e.keyCode==27&&(e.preventDefault(),$("a").focus()),e.keyCode==37&&cursorSpot>-$(input).val().length&&(cursorSwitch(2),cursorSpot--,$(fakeInput).html($(input).val().substr(0,$(input).val().length+cursorSpot)),$(fakeInputLast).html($(input).val().substr($(input).val().length+cursorSpot,$(input).val().length))),e.keyCode==39&&(cursorSpot<0&&(cursorSwitch(2),cursorSpot++,$(fakeInput).html($(input).val().substr(0,$(input).val().length+cursorSpot)),$(fakeInputLast).html($(input).val().substr($(input).val().length+cursorSpot,$(input).val().length))),cursorSpot==0&&cursorSwitch(1))}),console.kbash=function(e){$(mainConsole).append("<p>"+e+"</p>").scrollTop($(mainConsole)[0].scrollHeight)},kbash.e=function(e){var e=e||"ERROR:";return'<span class="red">'+e+"</span>"},kbash.s=function(e){var e=e||"SUCCESS:";return'<span class="green">'+e+"</span>"},kbash.help=function(e,t,n,r){var i=Object.getOwnPropertyNames(kbash);console.kbash('<span class="white">AVAILABLE COMMANDS</span>'),console.kbash('<span class="white">==================</span>');for(var s=0;s<i.length;s++)console.kbash(i[s]);console.kbash("&nbsp;"),console.kbash('<span class="white">DEMO</span>'),console.kbash('<span class="white">====</span>'),msg=t.have("v")?'try "say hello [-v] [--polite] [--rude]"':'Try "say hello" (or "help -v" for more options)',console.kbash(msg)},kbash.math=function(args,flags,opts,props){props.empty&&console.kbash("Please provide an equation to calculate");for(var i=0;i<args.length;i++)try{args[i].match(/^[-*/+0-9]+$/)?console.kbash(args[i]+' = <span class="white">'+parseFloat(eval(args[i]))+"</span>"):(console.kbash(kbash.e()+" Insecure string detected"),console.kbash("To prevent a script attack, this input will not be calculated."))}catch(e){console.kbash(kbash.e()+" Could not compute."),console.kbash("("+e+")")}},kbash.exit=function(){console.kbash("Goodbye"),$(nav).fadeOut("slow")},kbash.edit=function(){document.body.contentEditable="true",document.designMode="on",void 0,console.kbash(kbash.s("EDITING MODE")+": You may now edit this website.")};